{"componentChunkName":"component---src-templates-blog-post-js","path":"/yarnPnP에서-prisma-사용하기/","result":{"data":{"site":{"siteMetadata":{"title":"read0more's blog"}},"markdownRemark":{"id":"0a127351-59a0-523b-811c-52d0a9a6fb34","excerpt":"PnP에서 문제가 생기는 부분 prisma-client의 경우 node_module안에 생성을 해주는데, PnP환경에서는 없기 때문에 문제가 된다. 해결 방법 PnP를 지원하지 않는 패키지에 대한 호환성 문제를 해결 하기위해 yarn엔 pnpify…","html":"<h2>PnP에서 문제가 생기는 부분</h2>\n<p>prisma-client의 경우 node_module안에 생성을 해주는데, PnP환경에서는 없기 때문에 문제가 된다.</p>\n<h2>해결 방법</h2>\n<p>PnP를 지원하지 않는 패키지에 대한 호환성 문제를 해결 하기위해 yarn엔 pnpify라는 도구가 존재한다. 이를 통해 해결한다.</p>\n<ol>\n<li>yarn add @yarnpkg/pnpify</li>\n<li>schema.prisma의 generator client 안에 다음과 같이 client를 출력할 경로를 추가한다.(아래의 예시처럼 한다면 /prisma에 추가됨)</li>\n</ol>\n<pre><code>generator client {\n  provider = \"prisma-client-js\"\n  output   = \"./\"\n}\n</code></pre>\n<ol start=\"3\">\n<li>prisma-client import 편의성을 위해 package.json에 위에서 추가한 경로를 link로 추가해 준다.</li>\n</ol>\n<pre><code class=\"language-js\">{\n...\n\t\"dependencies\": {\n\t\t...\n\t\t\"prisma-client\": \"link:./prisma\",\n\t\t...\n\t}\n...\n}\n</code></pre>\n<ol start=\"4\">\n<li>yarn pnpify prisma db push, yarn pnpify prisma generate와 같이 pnpify를 붙여 명령어를 실행한다. studio 실행 시는 따로 안해도 괜찮다.</li>\n<li><a href=\"https://www.prisma.io/docs/guides/database/troubleshooting-orm/help-articles/nextjs-prisma-client-monorepo%EB%A5%BC\">https://www.prisma.io/docs/guides/database/troubleshooting-orm/help-articles/nextjs-prisma-client-monorepo를</a> 참고해서 next.config.js에 webpack관련 설정을 추가한다. monorepo가 아니라도 yarn PnP를 쓸 때 next에서 해당 플러그인을 사용하지 않으면 에러가 발생한다(현재 13.2.4 기준)</li>\n</ol>\n<h2>결론</h2>\n<p>PnP가 no install에 디스크 공간도 적게 차지하는 등의 매력적인 환경임에는 틀림 없지만, 이런 문제들로 인해 아직은 실무에서 적용하기에는 적지 않은 비용이 들 것임을 또 한번 느꼈다.</p>","frontmatter":{"title":"yarnPnP 환경에서 prisma-client 사용하기","date":"April 16, 2023","description":"PnP환경으로 생기는 문제와 해결방법"}},"previous":{"fields":{"slug":"/yarn-berry/"},"frontmatter":{"title":"Yarn Berry PnP구성"}},"next":null},"pageContext":{"id":"0a127351-59a0-523b-811c-52d0a9a6fb34","previousPostId":"1740aa06-b19f-5093-bf77-6abd30ec6631","nextPostId":null}},"staticQueryHashes":["2630815655","2841359383"],"slicesMap":{}}